---
title: "MSE Output Report"
output: pdf_document
params:
  mods: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(ggplot2); library(dplyr); library(tidyr); library(fmsb)
library(ggpubr); library(gridExtra); library(ggtern)
mods <- params$mods
is.nsim <- if (!is.list(mods[[1]][[1]][[1]])) FALSE else TRUE
output_dir <- '.'
width <- 10
height <- 7
dpi <- 300
col.opt <- 'D'
method <- 'median'
outlier.opt <- NA
plot.style <- 'median_iqr'
show.whisker <- TRUE
f.ymin <- NA
f.ymax <- 2
start.years <- 36
use.n.years.first <- 10
use.n.years.last <- 10
new_model_names <- c("PAN1", "PAN2", "PAN3", "PAN4", "PAN5")
base.model <- 'PAN5'
```

```{=latex}
\newpage
```

## Relative Trajectories of SSB and Catch

```{=latex}
\newpage
```
```{r trajectories}
plot_relative_trajectories1(mods, is.nsim, '.', output_dir, base.model, new_model_names, width, height, dpi, col.opt)
plot_relative_trajectories2(mods, is.nsim, '.', output_dir, base.model, new_model_names, width, height, dpi, col.opt)
```
```{=latex}
\newpage
```

# Realized Time Series of SSB, F, and Catch

```{=latex}
\newpage
```
```{r time_series}
plot_ssb_time_series(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, new_model_names)
plot_fbar_time_series(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, new_model_names)
plot_catch_time_series(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, new_model_names)
```
```{=latex}
\newpage
```

# Short-term Performance of SSB, F, and Catch

```{=latex}
\newpage
```
```{r Short-term Performance}
plot_ssb_performance2(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.first, start.years, new_model_names)
plot_fbar_performance2(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.first, start.years, new_model_names)
plot_catch_performance2(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.first, start.years, new_model_names)
```
```{=latex}
\newpage
```

# Short-term Performance of SSB, F, and Catch (Relative)

```{=latex}
\newpage
```
```{r Short-term Relative Performance}
plot_ssb_performance2(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.first, start.years, new_model_names, base.model)
plot_fbar_performance2(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.first, start.years, new_model_names, base.model)
plot_catch_performance2(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.first, start.years, new_model_names, base.model)
```
```{=latex}
\newpage
```

# Long-term Performance of SSB, F, and Catch

```{=latex}
\newpage
```
```{r Long-term Performance}
plot_ssb_performance(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, new_model_names)
plot_fbar_performance(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.last, new_model_names)
plot_catch_performance(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, new_model_names)
```
```{=latex}
\newpage
```

# Long-term Performance of SSB, F, and Catch (Relative)

```{=latex}
\newpage
```
```{r Relative Long-term Performance}
plot_ssb_performance(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, new_model_names, base.model)
plot_fbar_performance(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.last, new_model_names, base.model)
plot_catch_performance(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, new_model_names, base.model)
```
```{=latex}
\newpage
```

# Annual Variation in SSB, F, and Catch

```{=latex}
\newpage
```
```{r variation}
plot_ssb_variation(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, outlier.opt, new_model_names)
plot_fbar_variation(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, outlier.opt, new_model_names)
plot_catch_variation(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, outlier.opt, new_model_names)
```
```{=latex}
\newpage
```

# Annual Variation in SSB, F, and Catch (Relative)

```{=latex}
\newpage
```
```{r Relative variation}
plot_ssb_variation(mods, is.nsim, '.', output_dir, 'SSB', width, height, dpi, col.opt, outlier.opt, new_model_names, base.model)
plot_fbar_variation(mods, is.nsim, '.', output_dir, 'Fbar', width, height, dpi, col.opt, outlier.opt, new_model_names, base.model)
plot_catch_variation(mods, is.nsim, '.', output_dir, 'Catch', width, height, dpi, col.opt, outlier.opt, new_model_names, base.model)
```
```{=latex}
\newpage
```

# Stock Status and Probability of Overfishing and Overfished

```{=latex}
\newpage
```
```{r status}
plot_ssb_status(mods, is.nsim, '.', output_dir, 'SSB_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, new_model_names, base.model = NULL)
plot_ssb_status2(mods, is.nsim, '.', output_dir, 'SSB_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, start.years, new_model_names, base.model = NULL)
plot_fbar_status(mods, is.nsim, '.', output_dir, 'Fbar_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.last, new_model_names, base.model = NULL)
plot_fbar_status2(mods, is.nsim, '.', output_dir, 'Fbar_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.last, start.years, new_model_names, base.model = NULL)
```
```{=latex}
\newpage
```

# Stock Status in the Final Years (Relative)

```{=latex}
\newpage
```
```{r Relative status}
plot_ssb_status(mods, is.nsim, '.', output_dir, 'SSB_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, new_model_names, base.model, plot_prob = FALSE)
plot_ssb_status2(mods, is.nsim, '.', output_dir, 'SSB_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, use.n.years.last, start.years, new_model_names, base.model, plot_prob = FALSE)
plot_fbar_status(mods, is.nsim, '.', output_dir, 'Fbar_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.last, new_model_names, base.model, plot_prob = FALSE)
plot_fbar_status2(mods, is.nsim, '.', output_dir, 'Fbar_status', width, height, dpi, col.opt, method, outlier.opt, plot.style, show.whisker, f.ymin, f.ymax, use.n.years.last, start.years, new_model_names, base.model, plot_prob = FALSE)
```
```{=latex}
\newpage
```

# Stock Status in the Final Years (KOBE Plot)

```{=latex}
\newpage
```
```{r KOBE}
plot_kobe_status(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, new_model_names, use.n.years.last, show_density = FALSE)
plot_kobe_status(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, new_model_names, use.n.years.last, show_density = TRUE)
```
```{=latex}
\newpage
```

# Holistic Performance

```{=latex}
\newpage
```
```{r Holistic Performance}
plot_model_performance_radar(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, method, use.n.years.first, use.n.years.last, start.years, new_model_names)
plot_model_performance_triangle(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, method, new_model_names, use.n.years.first, use.n.years.last, start.years)
plot_model_performance_triangle2(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, method, new_model_names, use.n.years.first, use.n.years.last, start.years)
plot_status_triangle(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, method, new_model_names, use.n.years.first, use.n.years.last, start.years)
plot_model_performance_bar(mods, is.nsim, '.', output_dir, new_model_names, width, height, dpi, col.opt, method, use.n.years.first, use.n.years.last, start.years)
plot_AAV_performance(mods, is.nsim,'.', output_dir, width, height, dpi, new_model_names, col.opt)
```
```{=latex}
\newpage
```

# Model Diagnostics

```{=latex}
\newpage
```
```{r Diagnostics}
plot_mean_rec_par(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, outlier.opt, new_model_names)
plot_NAA_sigma_par(mods, is.nsim, '.', output_dir, width, height, dpi, col.opt, outlier.opt, new_model_names)
```
