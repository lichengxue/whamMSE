% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_and_generate_em_info.R
\name{filter_and_generate_em_info}
\alias{filter_and_generate_em_info}
\title{Filter Fleets and Indices for an Estimation Model}
\usage{
filter_and_generate_em_info(
  em_info,
  em.opt,
  ind_em,
  fleet_regions,
  index_regions,
  filter_indices = NULL,
  reduce_region_info = NULL,
  aggregate_weights_info = NULL
)
}
\arguments{
\item{em_info}{List. The original estimation model input data.}

\item{fleet_regions}{Integer vector. Specifies the region assignment of each fleet.}

\item{index_regions}{Integer vector. Specifies the region assignment of each index.}

\item{filter_indices}{Integer vector (optional). Indicates which indices to keep (1) or exclude (0).}

\item{reduce_region_info}{List (optional). Specifies modifications for regions. If `NULL`, no modifications are applied.
The expected components include:
\itemize{
  \item `$remove_regions`
    Specifies which regions should be removed from the model.
  \item `$reassign`
    Specifies reassignment of surveys from removed regions to non-removed regions.
  \item `$NAA_where`
    Specifies recruitment assignments after region reduction.
  \item `$sel_em`, `$M_em`, `$NAA_re_em`, `$move_em`, `$catchability_em` 
    Model settings that may change based on region reduction.
  \item `$onto_move_list`
    Contains movement-related parameters with the following elements:
    \itemize{
      \item `$onto_move` (array, dimension: `n_stocks × n_regions × (n_regions-1)`)  
        Specifies movement rules between stocks and regions. Default = NULL.
      \item `$onto_move_pars` (array, dimension: `n_stocks × n_regions × (n_regions-1) × 4`)  
        Specifies movement parameters. Default = NULL.
      \item `$age_mu_devs` (array, dimension: `n_stocks × n_regions × (n_regions-1) × n_ages`)  
        Stores age-based movement deviations. If `onto_move == 5`, values are extracted from `basic_info`.
    }
}}

\item{aggregate_weights_info}{List (optional). Specifies how to compute weighted averages for
weight-at-age (`waa`) and maturity-at-age during data aggregation (For panmictic and fleets-as-areas models only).
Used for aggregating across fleets or indices to form total/stock/regional summaries.
\itemize{
  \item `$ssb_waa_weights` List. Settings for weighting weight-at-age used for spawning stock biomass.
    \itemize{
      \item `$fleet` Logical. Whether to use fleet-specific weights.
      \item `$index` Logical. Whether to use index-specific weights.
      \item `$pointer` Integer. Index pointing to the selected fleet or index group (e.g., 1 means the first valid fleet group).
    }
  \item `$maturity_weights` List. Settings for weighting maturity-at-age used for spawning stock biomass.
    \itemize{
      \item `$fleet` Logical. Whether to use fleet-specific weights.
      \item `$index` Logical. Whether to use index-specific weights.
      \item `$pointer` Integer. Index pointing to the selected fleet or index group.
    }
}}
}
\value{
A list containing modified `em_info` lists for each region with filtered fleets, indices, renumbered index regions, and extracted weight-at-age (WAA) matrices.
}
\description{
This function filters fleets and indices based on region specifications
and removes indices marked for exclusion while ensuring correct renumbering.
Additionally, it extracts and correctly assembles the weight-at-age (WAA) matrix
for each region based on fleet, region, index, and stock assignments.
}
